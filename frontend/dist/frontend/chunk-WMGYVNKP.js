import{a as D}from"./chunk-7VOQBWOC.js";import{a as U}from"./chunk-2OR7M653.js";import{a as F}from"./chunk-ANM52DLC.js";import{a as T}from"./chunk-4N7PJ33N.js";import{b as I,d as w,g as A,q as E}from"./chunk-EHQ257GK.js";import{h as M,i as O,j as P}from"./chunk-DTPHU4DJ.js";import{Ea as l,Ja as f,Mb as C,Na as g,Nb as S,Qb as k,Wa as u,Xa as t,Ya as n,Za as b,cb as d,gb as i,hb as m,ib as h,jb as x,kb as v,lb as _,ua as c,zb as y}from"./chunk-GOBX2HRP.js";function j(s,r){if(s&1&&(t(0,"button",32)(1,"span",33),i(2),n(),t(3,"span",34),i(4),n()()),s&2){let o=r.$implicit;u("routerLink",o.route),c(2),m(o.icon),c(2),m(o.title)}}function R(s,r){s&1&&(t(0,"div",35)(1,"h2"),i(2,"Bienvenido a YARG Flow \u{1F44B}"),n(),t(3,"p",36),i(4," Selecciona una conversaci\xF3n en el men\xFA lateral o inicia un nuevo chat. "),n(),t(5,"p",37),i(6," Usa la barra de b\xFAsqueda de arriba para encontrar canales y contactos. "),n()())}var z=class s{constructor(r,o,e,a,p,B){this.sessionService=r;this.router=o;this.toast=e;this.userService=a;this.cdr=p;this.messageService=B}currentUserAlias=null;searchText="";hasChildActive=!1;menuSections=[{title:"Conversaciones",icon:"\u{1F4AC}",route:"/dashboard/conversations"},{title:"Canales",icon:"\u{1F4E1}",route:"/dashboard/channels"},{title:"Configuraci\xF3n",icon:"\u2699\uFE0F",route:"/dashboard/settings"},{title:"Perfil",icon:"\u{1F464}",route:"/dashboard/profile"}];activityIntervalId;ngOnInit(){let r=localStorage.getItem("token");if(!r){this.router.navigate(["/auth"]);return}this.sessionService.getByToken(r).subscribe({next:o=>{console.log("[Dashboard] sesi\xF3n OK",o),this.loadUserAliasAndStartRefresh(o);try{this.messageService.getPendingConversationsCount(o.userId).subscribe({next:e=>{console.log("[Dashboard] pending convs",e)},error:()=>{}})}catch{}},error:()=>{localStorage.removeItem("token"),this.router.navigate(["/auth"])}})}ngOnDestroy(){this.activityIntervalId&&clearInterval(this.activityIntervalId)}loadUserAliasAndStartRefresh(r){let o=r.userId;this.userService.getUserById(o).subscribe({next:e=>{console.log("[Dashboard] usuario OK",e),this.currentUserAlias=e.username||e.displayName||"Usuario",this.cdr.detectChanges()},error:e=>{console.error("[Dashboard] error getUserById",e),this.currentUserAlias="Usuario",this.cdr.detectChanges()}}),this.activityIntervalId=setInterval(()=>{this.sessionService.refreshActivity().subscribe()},3e4)}onChildActivate(){this.hasChildActive=!0}onChildDeactivate(){this.hasChildActive=!1}addFriend(){console.log("A\xF1adir amigo")}viewNotifications(){console.log("Ver notificaciones")}getHelp(){console.log("Ayuda o soporte")}onSearch(){console.log("Buscando:",this.searchText)}logout(){console.log("Cerrando sesi\xF3n...");let r=localStorage.getItem("token");if(!r){localStorage.removeItem("token"),this.router.navigate(["/auth"]);return}this.sessionService.getByToken(r).subscribe({next:o=>{let e=o?.sessionId||o?.id;e?this.sessionService.logout(e).subscribe({next:()=>{localStorage.removeItem("token"),this.router.navigate(["/auth"])},error:()=>{localStorage.removeItem("token"),this.toast.show("Tu sesi\xF3n expir\xF3. Inicia sesi\xF3n de nuevo.","info"),this.router.navigate(["/auth"])}}):(localStorage.removeItem("token"),this.router.navigate(["/auth"]))},error:()=>{localStorage.removeItem("token"),this.router.navigate(["/auth"])}})}static \u0275fac=function(o){return new(o||s)(l(T),l(O),l(D),l(F),l(y),l(U))};static \u0275cmp=f({type:s,selectors:[["app-dashboard"]],decls:51,vars:4,consts:[[1,"dashboard-shell"],[1,"topbar"],[1,"topbar-left"],[1,"app-logo"],[1,"app-meta"],[1,"app-title"],[1,"app-subtitle"],[1,"topbar-center"],[1,"topbar-actions"],[1,"chip-button",3,"click"],[1,"search-wrapper"],[1,"search-icon"],["type","text","placeholder","Buscar conversaci\xF3n o canal",1,"search-input",3,"ngModelChange","keyup.enter","ngModel"],[1,"topbar-right"],[1,"topbar-user-btn"],[1,"icon"],[1,"topbar-user-alias"],[1,"logout-button",3,"click"],[1,"dashboard-main"],[1,"sidebar"],[1,"sidebar-header"],[1,"sidebar-title"],[1,"menu-sections"],["class","menu-section","type","button","routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf"],[1,"sidebar-footer"],[1,"status-dot"],[1,"status-text"],[1,"workspace"],[3,"activate","deactivate"],["class","workspace-empty",4,"ngIf"],[1,"dashboard-footer"],[1,"dot-separator"],["type","button","routerLinkActive","active",1,"menu-section",3,"routerLink"],[1,"menu-icon"],[1,"menu-title"],[1,"workspace-empty"],[1,"empty-text"],[1,"empty-hint"]],template:function(o,e){o&1&&(t(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3),i(4,"YF"),n(),t(5,"div",4)(6,"h1",5),i(7,"YARG Flow"),n(),t(8,"span",6),i(9,"Mensajer\xEDa en tiempo real"),n()()(),t(10,"div",7)(11,"div",8)(12,"button",9),d("click",function(){return e.addFriend()}),i(13,"\uFF0B Amigo"),n(),t(14,"button",9),d("click",function(){return e.viewNotifications()}),i(15,"\u{1F514} Notif."),n(),t(16,"button",9),d("click",function(){return e.getHelp()}),i(17,"\u2753 Ayuda"),n()(),t(18,"div",10)(19,"span",11),i(20,"\u{1F50D}"),n(),t(21,"input",12),_("ngModelChange",function(p){return v(e.searchText,p)||(e.searchText=p),p}),d("keyup.enter",function(){return e.onSearch()}),n()()(),t(22,"div",13)(23,"button",14)(24,"span",15),i(25,"\u{1F464}"),n(),t(26,"span",16),i(27),n()(),t(28,"button",17),d("click",function(){return e.logout()}),i(29,"Salir"),n()()(),t(30,"div",18)(31,"aside",19)(32,"div",20)(33,"span",21),i(34,"Navegaci\xF3n"),n()(),t(35,"nav",22),g(36,j,5,3,"button",23),n(),t(37,"div",24),b(38,"span",25),t(39,"span",26),i(40,"Conectado"),n()()(),t(41,"main",27)(42,"router-outlet",28),d("activate",function(){return e.onChildActivate()})("deactivate",function(){return e.onChildDeactivate()}),n(),g(43,R,7,0,"div",29),n()(),t(44,"footer",30)(45,"span"),i(46,"\xA9 2025 YARG FLOW"),n(),t(47,"span",31),i(48,"\u2022"),n(),t(49,"span"),i(50,"Proyecto PF \xB7 Universidad"),n()()()),o&2&&(c(21),x("ngModel",e.searchText),c(6),h(" ",e.currentUserAlias||"Usuario"," "),c(9),u("ngForOf",e.menuSections),c(7),u("ngIf",!e.hasChildActive))},dependencies:[k,C,S,E,I,w,A,M,P],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block;height:100vh;background:#020617;color:#e5e7eb;font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif}.dashboard-shell[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.topbar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:10px 18px;background:#020617;border-bottom:1px solid #111827;gap:12px}.topbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.app-logo[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:999px;background:radial-gradient(circle at 30% 30%,#22c55e,#4f46e5);display:flex;justify-content:center;align-items:center;font-weight:800;font-size:16px;color:#f9fafb}.app-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column}.app-title[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600}.app-subtitle[_ngcontent-%COMP%]{font-size:11px;color:#9ca3af}.topbar-center[_ngcontent-%COMP%]{display:flex;flex:1;align-items:center;gap:10px;justify-content:center}.topbar-actions[_ngcontent-%COMP%]{display:flex;gap:6px}.chip-button[_ngcontent-%COMP%]{border:1px solid #1f2937;background:#020617;color:#e5e7eb;border-radius:999px;padding:4px 10px;font-size:12px;cursor:pointer;display:inline-flex;align-items:center;gap:6px;transition:background .15s ease,border-color .15s ease,transform .1s ease}.chip-button[_ngcontent-%COMP%]:hover{background:#111827;border-color:#22c55e;transform:translateY(-1px)}.search-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;background:#020617;border-radius:999px;border:1px solid #1f2937;padding:4px 10px;gap:6px;min-width:260px}.search-icon[_ngcontent-%COMP%]{font-size:14px;color:#6b7280}.search-input[_ngcontent-%COMP%]{border:none;background:transparent;color:#f9fafb;font-size:13px;outline:none;width:100%}.search-input[_ngcontent-%COMP%]::placeholder{color:#6b7280}.topbar-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.user-pill[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;background:#020617;border-radius:999px;border:1px solid #1f2937;padding:4px 10px;font-size:12px}.user-avatar[_ngcontent-%COMP%]{font-size:14px}.user-name[_ngcontent-%COMP%]{color:#e5e7eb}.logout-button[_ngcontent-%COMP%]{border-radius:999px;border:none;padding:6px 12px;font-size:12px;font-weight:600;background:#ef4444;color:#f9fafb;cursor:pointer;transition:background .15s ease,transform .1s ease,box-shadow .1s ease}.logout-button[_ngcontent-%COMP%]:hover{background:#b91c1c;box-shadow:0 0 10px #f8717166;transform:translateY(-1px)}.dashboard-main[_ngcontent-%COMP%]{display:flex;flex:1;min-height:0}.sidebar[_ngcontent-%COMP%]{width:220px;background:#020617;border-right:1px solid #111827;display:flex;flex-direction:column;padding:10px 8px;gap:10px}.sidebar-header[_ngcontent-%COMP%]{padding:4px 8px;font-size:11px;color:#9ca3af;text-transform:uppercase;letter-spacing:.08em}.menu-sections[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.menu-section[_ngcontent-%COMP%]{width:100%;border-radius:10px;border:none;background:transparent;color:#e5e7eb;display:flex;align-items:center;justify-content:flex-start;gap:8px;padding:8px 10px;cursor:pointer;font-size:13px;text-align:left;transition:background .15s ease,transform .1s ease}.menu-section[_ngcontent-%COMP%]:hover{background:#111827;transform:translateY(-1px)}.menu-icon[_ngcontent-%COMP%]{width:20px;text-align:center}.menu-title[_ngcontent-%COMP%]{flex:1}.sidebar-footer[_ngcontent-%COMP%]{margin-top:auto;padding:6px 8px;display:flex;align-items:center;gap:6px;font-size:11px;color:#9ca3af;border-top:1px solid #111827}.status-dot[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:999px;background:#22c55e}.workspace[_ngcontent-%COMP%]{flex:1;background:radial-gradient(circle at top left,#111827,#020617);padding:0;position:relative;overflow-y:auto;overflow-x:hidden}.workspace-empty[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;pointer-events:none;text-align:center}.workspace-empty[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;margin-bottom:8px}.empty-text[_ngcontent-%COMP%]{font-size:13px;color:#9ca3af;margin-bottom:4px}.empty-hint[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.dashboard-footer[_ngcontent-%COMP%]{padding:6px 14px;font-size:11px;color:#6b7280;background:#020617;border-top:1px solid #111827;display:flex;align-items:center;gap:6px;justify-content:flex-end}.dot-separator[_ngcontent-%COMP%]{opacity:.6}@media (max-width: 900px){.sidebar[_ngcontent-%COMP%]{display:none}.dashboard-main[_ngcontent-%COMP%]{flex-direction:column}.workspace[_ngcontent-%COMP%]{padding:10px 12px}.topbar-user-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;background:transparent;border:none;color:#e5e7eb;font-weight:500;cursor:pointer}.topbar-user-alias[_ngcontent-%COMP%]{color:#a5b4fc}}']})};export{z as Dashboard};
