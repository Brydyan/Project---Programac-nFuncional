<!-- src/app/pages/dashboard/conversations/conversations.html -->

<div class="conversations-wrapper">
  <!-- Barra superior de la secci√≥n -->
  <div class="conversations-header">
    <div class="tabs">
      <button class="tab active">Conversaciones</button>
      <button class="tab">Canales</button>
      <button class="tab">Settings</button>
    </div>

    <button class="new-conversation-btn" (click)="newConversation()">
      + Nueva Conversaci√≥n
    </button>
  </div>

  <h2 class="conversations-title">Conversaciones</h2>

  <!-- Lista de conversaciones -->
  <div class="conversations-list">
    <button
      class="conversation-card"
      *ngFor="let conv of conversations"
      type="button"
      (click)="openConversation(conv)"
    >
      <div class="conversation-avatar">
        <img [src]="conv.avatarUrl" [alt]="conv.name" />
      </div>

      <div class="conversation-main">
        <div class="conversation-header-line">
          <span class="conversation-name">{{ conv.name }}</span>
          <span class="conversation-time">{{ conv.lastTimeLabel }}</span>
        </div>
        <div class="conversation-message">
          {{ conv.lastMessage }}
        </div>
      </div>
    </button>
  </div>

  <!-- Footer inferior dentro del panel principal (opcional) -->
  <div class="conversations-footer">
    <span>Enlaces R√°pidos</span>
    <span>¬∑</span>
    <span>Soporte</span>
  </div>
</div>
<div class="new-conversation-layer" *ngIf="showNewConversation">
  <div class="new-conversation-backdrop" (click)="closeNewConversation()"></div>

  <div class="new-conversation-panel" (click)="$event.stopPropagation()">
    <header class="new-conversation-header">
      <div class="header-titles">
        <h3>Iniciar nueva conversaci√≥n</h3>
        <p>Busca un usuario por nombre o @usuario para empezar a chatear.</p>
      </div>
      <button class="close-btn" type="button" (click)="closeNewConversation()">‚úï</button>
    </header>

    <div class="new-conversation-search">
      <span class="search-icon">üîç</span>
      <input
        type="text"
        placeholder="Buscar por nombre o @usuario"
        [(ngModel)]="searchTerm"
        (input)="onSearchChange()"
      />
    </div>

    <div class="new-conversation-results">
      <p class="empty-hint" *ngIf="!searchTerm">
        Escribe para buscar personas‚Ä¶
      </p>

      <p class="empty-hint" *ngIf="searchTerm && searchResults.length === 0">
        No se encontraron usuarios para "{{ searchTerm }}".
      </p>

      <button
        *ngFor="let user of searchResults"
        type="button"
        class="search-result-item"
        (click)="startConversationWith(user)"
      >
        <div class="avatar">
          <img
            [src]="user.avatarUrl || ('https://i.pravatar.cc/100?u=' + user.id)"
            [alt]="user.displayName"
          />
        </div>
        <div class="user-main">
          <span class="user-name">{{ user.displayName }}</span>
          <span class="user-username">@{{ user.username }}</span>
        </div>
      </button>
    </div>
  </div>
</div>